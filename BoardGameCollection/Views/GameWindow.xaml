<Window x:Class="BoardGameCollection.Views.GameWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BoardGameCollection.Views"
        xmlns:models="clr-namespace:BoardGameCollection.Models"
        xmlns:converters="clr-namespace:BoardGameCollection.Converters"
        mc:Ignorable="d"
        Title="Добавить/Редактировать игру" Height="650" Width="800"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Информация об игре" FontSize="24" FontWeight="Bold" Margin="0,0,0,15"/>

        <ScrollViewer Grid.Row="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Левая колонка - основная информация -->
                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                    <!-- Название -->
                    <TextBlock Text="Название игры *" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBox Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Text="{Binding TitleValidationMessage}" Foreground="Red" Visibility="{Binding TitleValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"/>

                    <!-- Жанр -->
                    <TextBlock Text="Жанр *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <ComboBox ItemsSource="{Binding Source={x:Type models:Genre}, Converter={StaticResource EnumToCollectionConverter}}" 
                              SelectedItem="{Binding SelectedGenre}"/>

                    <!-- Сложность -->
                    <TextBlock Text="Сложность *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <ComboBox ItemsSource="{Binding Source={x:Type models:Difficulty}, Converter={StaticResource EnumToCollectionConverter}}" 
                              SelectedItem="{Binding SelectedDifficulty}"/>

                    <!-- Количество игроков -->
                    <TextBlock Text="Количество игроков *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="От" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Width="70" Text="{Binding MinPlayers, UpdateSourceTrigger=PropertyChanged}"/>
                        <TextBlock Text="до" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox Width="70" Text="{Binding MaxPlayers, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <TextBlock Text="{Binding PlayersValidationMessage}" Foreground="Red" Visibility="{Binding PlayersValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"/>

                    <!-- Время игры -->
                    <TextBlock Text="Время игры (минуты) *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBox Text="{Binding PlayTime, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Text="{Binding PlayTimeValidationMessage}" Foreground="Red" Visibility="{Binding PlayTimeValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"/>
                </StackPanel>

                <!-- Правая колонка - дополнительная информация -->
                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                    <!-- Издатель -->
                    <TextBlock Text="Издатель" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBox Text="{Binding Publisher}"/>

                    <!-- Год издания -->
                    <TextBlock Text="Год издания *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBox Text="{Binding YearPublished, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Text="{Binding YearValidationMessage}" Foreground="Red" Visibility="{Binding YearValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"/>

                    <!-- Рейтинг BGG -->
                    <TextBlock Text="Рейтинг BGG (1-10)" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBox Text="{Binding BggRating, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Text="{Binding BggRatingValidationMessage}" Foreground="Red" Visibility="{Binding BggRatingValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"/>

                    <!-- Личный рейтинг -->
                    <TextBlock Text="Ваш рейтинг (1-10) *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <Slider Minimum="1" Maximum="10" Value="{Binding PersonalRating}" TickFrequency="1" IsSnapToTickEnabled="True"/>
                    <TextBlock Text="{Binding PersonalRating}" HorizontalAlignment="Center" FontWeight="Bold"/>

                    <!-- Статус -->
                    <TextBlock Text="Статус *" FontWeight="Bold" Margin="0,10,0,5"/>
                    <ComboBox ItemsSource="{Binding Source={x:Type models:GameStatus}, Converter={StaticResource EnumToCollectionConverter}}" 
                              SelectedItem="{Binding SelectedStatus}"/>

                    <!-- Теги -->
                    <TextBlock Text="Теги" FontWeight="Bold" Margin="0,10,0,5"/>
                    <ListBox ItemsSource="{Binding AllTags}" SelectionMode="Multiple">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- Индикатор загрузки и ошибки -->
        <Grid Grid.Row="2" Margin="0,10">
            <ProgressBar IsIndeterminate="True" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <TextBlock Text="{Binding ErrorMessage}" Foreground="Red" Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"/>
        </Grid>

        <!-- Кнопки -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="Сохранить" Command="{Binding SaveCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
            <Button Content="Отмена" Command="{Binding CancelCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
        </StackPanel>
    </Grid>
</Window>